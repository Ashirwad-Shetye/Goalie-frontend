{"ast":null,"code":"import axios from\"axios\";import isEmpty from\"lodash/isEmpty\";import{getItemFromStorage}from\"./storage\";import{DEFAULT_URL,authHeaderKeys}from\"./constants\";export var setAuthHeaders=function setAuthHeaders(config){if(!isEmpty(getItemFromStorage(\"token\"))){authHeaderKeys.forEach(function(key){if(key.toLowerCase()===\"authorization\".toLowerCase()){config.headers.common[key]=\"Bearer \".concat(getItemFromStorage(\"token\"));}else{if(getItemFromStorage(key)){config.headers.common[key]=getItemFromStorage(key);}}});}return config;};export var setAuthHeadersAfterLogin=function setAuthHeadersAfterLogin(headers){var accessToken=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;console.log(headers);axios.defaults.headers[\"authorization\"]=\"Bearer \".concat(accessToken);//   authHeaderKeys.forEach((key) => {\n//     if (key.toLowerCase() === \"authorization\".toLowerCase() && accessToken) {\n//       axios.defaults.headers.common[key] = `Bearer ${accessToken}`;\n//     } else {\n//       if (!isEmpty(headers[key])) {\n//         axios.defaults.headers.common[key] = headers[key];\n//       }\n//     }\n//   });\n};axios.defaults.baseURL=DEFAULT_URL;axios.defaults.timeout=120000;axios.defaults.headers.common[\"Content-Type\"]=\"application/json\";axios.defaults.headers.common.Accept=\"application/json\";axios.defaults.headers.common.Platform=\"Web\";var instance=axios.create();export var basicInstance=axios.create();var handleErrors=function handleErrors(){var store=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var error=arguments.length>1?arguments[1]:undefined;console.log(error);if(process.env.NODE_ENV===\"development\"){// console.log(\"Error Logging :: \", error.message, JSON.stringify(error))\n}if(error.message){if(error.message===\"Network Error\"){// store.dispatch(showToaster({message: 'No Internet connection. Please check your internet settings', type: 'error'}))\nreturn Promise.reject(error);}}if(!error.response){if(error.code===\"ECONNABORTED\"){// store.dispatch(showToaster({type:'error', message: error.message}))\nvar timeoutError=error;timeoutError.response={data:{}};return Promise.reject(timeoutError);}// store.dispatch(showToaster({type: 'error', message: error.message }))\nreturn Promise.reject(error);}if(error.response){var errorMessage=\"Something Went Wrong\";switch(error.response.status){case 400:if(error.response.data.errors){errorMessage=error.response.data.errors;}// store.dispatch(showToaster({message: errorMessage, type: 'error'}))\nbreak;default:// store.dispatch(showToaster({ type: 'error', message: error.message}))\n}}return Promise.reject(error);};export var setupBasicInterceptor=function setupBasicInterceptor(){instance.interceptors.response.use(function(response){return Promise.resolve(response);},function(error){return Promise.reject(error);});instance.interceptors.request.use(function(config){return setAuthHeaders(config);},function(error){return Promise.reject(error);});};export default instance;","map":{"version":3,"names":["axios","isEmpty","getItemFromStorage","DEFAULT_URL","authHeaderKeys","setAuthHeaders","config","forEach","key","toLowerCase","headers","common","setAuthHeadersAfterLogin","accessToken","console","log","defaults","baseURL","timeout","Accept","Platform","instance","create","basicInstance","handleErrors","store","error","process","env","NODE_ENV","message","Promise","reject","response","code","timeoutError","data","errorMessage","status","errors","setupBasicInterceptor","interceptors","use","resolve","request"],"sources":["/home/dilip/Desktop/pesto/project/Goalie-frontend/src/services/base.js"],"sourcesContent":["import axios from \"axios\";\nimport isEmpty from \"lodash/isEmpty\";\nimport { getItemFromStorage } from \"./storage\";\nimport { DEFAULT_URL, authHeaderKeys } from \"./constants\";\n\nexport const setAuthHeaders = (config) => {\n  if (!isEmpty(getItemFromStorage(\"token\"))) {\n    authHeaderKeys.forEach((key) => {\n      if (key.toLowerCase() === \"authorization\".toLowerCase()) {\n        config.headers.common[key] = `Bearer ${getItemFromStorage(\"token\")}`;\n      } else {\n        if (getItemFromStorage(key)) {\n          config.headers.common[key] = getItemFromStorage(key);\n        }\n      }\n    });\n  }\n  return config;\n};\n\nexport const setAuthHeadersAfterLogin = (headers, accessToken = null) => {\n  console.log(headers);\n  axios.defaults.headers[\"authorization\"] = `Bearer ${accessToken}`;\n  //   authHeaderKeys.forEach((key) => {\n  //     if (key.toLowerCase() === \"authorization\".toLowerCase() && accessToken) {\n  //       axios.defaults.headers.common[key] = `Bearer ${accessToken}`;\n  //     } else {\n  //       if (!isEmpty(headers[key])) {\n  //         axios.defaults.headers.common[key] = headers[key];\n  //       }\n  //     }\n  //   });\n};\n\naxios.defaults.baseURL = DEFAULT_URL;\naxios.defaults.timeout = 120000;\naxios.defaults.headers.common[\"Content-Type\"] = \"application/json\";\naxios.defaults.headers.common.Accept = \"application/json\";\naxios.defaults.headers.common.Platform = \"Web\";\n\nconst instance = axios.create();\n\nexport const basicInstance = axios.create();\n\nconst handleErrors = (store = null, error) => {\n  console.log(error);\n  if (process.env.NODE_ENV === \"development\") {\n    // console.log(\"Error Logging :: \", error.message, JSON.stringify(error))\n  }\n  if (error.message) {\n    if (error.message === \"Network Error\") {\n      // store.dispatch(showToaster({message: 'No Internet connection. Please check your internet settings', type: 'error'}))\n      return Promise.reject(error);\n    }\n  }\n  if (!error.response) {\n    if (error.code === \"ECONNABORTED\") {\n      // store.dispatch(showToaster({type:'error', message: error.message}))\n      const timeoutError = error;\n      timeoutError.response = {\n        data: {},\n      };\n      return Promise.reject(timeoutError);\n    }\n    // store.dispatch(showToaster({type: 'error', message: error.message }))\n    return Promise.reject(error);\n  }\n  if (error.response) {\n    let errorMessage = \"Something Went Wrong\";\n    switch (error.response.status) {\n      case 400:\n        if (error.response.data.errors) {\n          errorMessage = error.response.data.errors;\n        }\n        // store.dispatch(showToaster({message: errorMessage, type: 'error'}))\n        break;\n      default:\n      // store.dispatch(showToaster({ type: 'error', message: error.message}))\n    }\n  }\n  return Promise.reject(error);\n};\n\nexport const setupBasicInterceptor = () => {\n  instance.interceptors.response.use(\n    (response) => Promise.resolve(response),\n    (error) => Promise.reject(error)\n  );\n  instance.interceptors.request.use(\n    (config) => setAuthHeaders(config),\n    (error) => Promise.reject(error)\n  );\n};\n\nexport default instance;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}